<div class="container">
    <header class="header">
        <div class="logo-placeholder">Logo</div>
        <h2>Revisão e Refinamento do Backlog</h2>
        <p class="subtitle">Projeto: Sistema de Gestão de Vendas</p>
    </header>

    <div class="lista-historias">
        <div class="card-historia" *ngFor="let historia of historias">

            <div class="conteudo">

                <div class="texto-historia" *ngIf="!historia.editando">
                    <span class="seta">></span>
                    Como <strong>{{ historia.papel }}</strong>,
                    eu quero <strong>{{ historia.acao }}</strong>
                    para <strong>{{ historia.beneficio }}</strong>
                </div>

                <div class="modo-edicao" *ngIf="historia.editando">
                    <div class="input-group">
                        <span>Como</span>
                        <input [(ngModel)]="historia.papel" placeholder="Papel (Ex: Usuário)">
                    </div>
                    <div class="input-group">
                        <span>quero</span>
                        <input [(ngModel)]="historia.acao" placeholder="Ação (Ex: adicionar produtos ao carrinho)">
                    </div>
                    <div class="input-group">
                        <span>para</span>
                        <input [(ngModel)]="historia.beneficio" placeholder="Benefício (Ex: completar minha compra rapidamente)">
                    </div>
                    
                    <div class="input-group-meta">
                        <label for="prioridade-{{historia.id}}">Prioridade:</label>
                        <select id="prioridade-{{historia.id}}" [(ngModel)]="historia.prioridade">
                            <option value="ALTA">ALTA</option>
                            <option value="MEDIA">MÉDIA</option>
                            <option value="BAIXA">BAIXA</option>
                        </select>
                        <label for="estimativa-{{historia.id}}">Estimativa:</label>
                        <input id="estimativa-{{historia.id}}" type="text" [(ngModel)]="historia.estimativa" placeholder="4h / P / 3 pontos">
                    </div>
                </div>

                <div class="tags">
                    <span class="tag prioridade" [class]="historia.prioridade | lowercase">
                        {{ historia.prioridade }}
                    </span>
                    <span class="tag estimativa">
                        {{ historia.estimativa }}
                    </span>
                    <span *ngIf="historia.jiraIssueKey" class="tag jira-key">
                        <a [href]="'https://cesar-team-qbew2ary.atlassian.net/browse/' + historia.jiraIssueKey" target="_blank" class="jira-link">
                            Jira: {{ historia.jiraIssueKey }}
                        </a>
                    </span>
                </div>
            </div>

            <div class="div-acões">
                <button class="btn-icon primary" (click)="alternarEdicao(historia)">
                    {{ historia.editando ? 'Salvar' : 'Editar' }}
                </button>
                <button class="btn-icon delete" (click)="deletar(historia.id)">Deletar</button>
                
                <button class="btn-icon jira" *ngIf="!historia.jiraIssueKey" (click)="enviarParaJira(historia)">
                    Enviar para Jira
                </button>
            </div>
        </div>
    </div>

    <div class="footer-actions">
        <button class="btn-primary large" (click)="navegarParaRoadmap()">APROVAR BACKLOG E VER ROADMAP</button>
    </div>
</div>